<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="努力成为一名实力很强的小白"><title>朴素贝叶斯与拉普拉斯平滑简介 | TiuVe</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.1"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.1"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="stylesheet" type="text/css" href="/css/donate.css"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">朴素贝叶斯与拉普拉斯平滑简介</h1><a id="logo" href="/.">TiuVe</a><p class="description">气蒸云梦泽，波撼岳阳城</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/./archives/"><i class="fa fa-archive"> 归档</i></a><a href="/./about/about.html"><i class="fa fa-user"> 关于</i></a><a href="/./project/project.html"><i class="fa fa-archive"> work</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="搜索"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">朴素贝叶斯与拉普拉斯平滑简介</h1><div class="post-meta"><a href="/2018/10/31/朴素贝叶斯与拉普拉斯平滑简介/#comments" class="comment-count"></a><p><span class="date">Oct 31, 2018</span><span><a href="/categories/推荐/" class="category">推荐</a></span></p></div><div class="post-content"><p>今天我们从极大似然估计说起，然后阐述一下朴素贝叶斯分类算法和贝叶斯估计，最后介绍M估计和拉普拉斯平滑方法，其主要解决了零概率问题。</p>
<h2 id="1-极大似然法"><a href="#1-极大似然法" class="headerlink" title="1 极大似然法"></a>1 极大似然法</h2><p>极大似然法是一种<strong>根据样本估计模型参数</strong>的方法，通过观测样本构造似然函数，然后令似然函数的极值为0进而确定模型参数。</p>
<p>假设我们有一枚硬币，抛出后正面朝上的概率为p(0&lt;p&lt;1)。现在我们抛出了49个正面(H)，31个反面(T)。我们来求其似然函数的最大值：</p>
<p>$$f(\theta)&#x3D;f_D(H&#x3D;49,T&#x3D;80-49|p)&#x3D;\left(\frac{80}{49}\right)p^{49}(1-p)^{31} \tag{1.1}$$</p>
<p>我们对方程两边同时取微分，并使其为零。</p>
<p>$$<br>\begin{aligned}<br>0&amp;&#x3D;\frac{d}{dp}\left(\left(\frac{80}{49}\right)p^{49}(1-p)^{31}\right) \<br>&amp;\infty 49p^{48}(1-p)^{31}-31p^{49}(1-p)^{30}\<br>&amp;&#x3D;p^{48}(1-p)^{30}[49(1-p)-31p] \<br>\end{aligned} \tag{1.2}<br>$$</p>
<p>其解为p&#x3D;0,p&#x3D;1，以及p&#x3D;49&#x2F;80。使可能性最大的解显然是p&#x3D;49&#x2F;80，p&#x3D;0和p&#x3D;1这两个解会使可能性为零）。因此我们说最大似然估计值为49&#x2F;80。</p>
<p>这个结果很容易一般化。只需要用一个字母t代替49用以表达伯努利试验中的被观察数据（即样本）的“成功”次数，用另一个字母n代表伯努利试验的次数即可。使用完全同样的方法即可以得到最大似然估计值:</p>
<p>$$<br>\hat{p}&#x3D;\frac{t}{n} \tag{1.3}<br>$$</p>
<p>对于任何成功次数为t，试验总数为n的伯努利试验。<br>以上就是用极大似然法求解离散分布，连续参数空间的情况。</p>
<h2 id="2-朴素贝叶斯"><a href="#2-朴素贝叶斯" class="headerlink" title="2 朴素贝叶斯"></a>2 朴素贝叶斯</h2><p>朴素贝叶斯是基于<strong>贝叶斯定理</strong>与<strong>特征条件独立假设</strong>的<strong>分类</strong>方法。对于给定的训练数据集，首先基于特征条件独立假设 学习输入&#x2F;输出的<strong>联合概率分布</strong>；然后基于此模型，对于给定的输入x，利用贝叶斯定理求出后验概率最大的输出y。</p>
<p><strong>先验概率</strong><br>在贝叶斯统计中，某一不确定量p的先验概率分布是在考虑”观测数据”前，能表达p不确定性的概率分布。</p>
<p><strong>后验概率</strong>  （知道“果”，推测“因”的概率）<br>在贝叶斯统计中，一个随机事件的后验概率是在考虑相关证据 ( 观测数据 ) 后所得到的条件概率。换句话说，后验概率分布是一个随机变量基于试验得到的概率分布。</p>
<h3 id="2-1-联合概率分布"><a href="#2-1-联合概率分布" class="headerlink" title="2.1 联合概率分布"></a>2.1 联合概率分布</h3><p>在概率论中, 对两个随机变量X和Y，其联合分布是同时对于X和Y的概率分布。</p>
<p>对离散随机变量而言，联合分布概率质量函数为$P(X &#x3D; x , and , Y &#x3D; y)$，即</p>
<p>$$<br>P(X&#x3D;x , and , Y&#x3D;y)&#x3D;P(Y&#x3D;y|X&#x3D;x)P(X&#x3D;x)&#x3D;p(X&#x3D;x|Y&#x3D;y)P(Y&#x3D;y) \tag{2.1}<br>$$</p>
<p>因为是概率分布函数，所以必须有</p>
<p>$$\sum_{x}{\sum_{y}{f_{X,Y}(x,y)dy dx}}&#x3D;1 \tag{2.2} $$</p>
<h3 id="2-2-朴素贝叶斯的推导"><a href="#2-2-朴素贝叶斯的推导" class="headerlink" title="2.2 朴素贝叶斯的推导"></a>2.2 朴素贝叶斯的推导</h3><p>给定训练集 $T&#x3D;\{(x_1,y_1),(x_2,y_2),..,(x_N,y_N)\}$，其由 $P(X,Y)$ 独立同分布产生。朴素贝叶斯法通过训练数据集学习联合概率分布$P(X,Y)$。具体地，学习以下先验分布和条件概率分布。先验分布$P(Y&#x3D;c_k),k&#x3D;1,2,…,K$,条件概率分布</p>
<p>$$P(X&#x3D;x|Y&#x3D;c_k)&#x3D;P(x^{(1)}&#x3D;X^{(1)},…,x^{(n)}|Y&#x3D;c_k),k&#x3D;1,2,…,K$$</p>
<p>最后学习到联合概率分布$P(X,Y)$。</p>
<p>但是条件概率分布$P(X&#x3D;x|Y&#x3D;c_k)$有指数量级的参数。其估计是不可行的。假设$x^i$的取值有$S_j$个，Y的取值有$K$个，那么参数个数为$K\prod_{j&#x3D;1}^n{S_j}$。</p>
<p>朴素贝叶斯对条件概率分布做了独立性的假设,假设分类的特征在类确定的条件下都是相互独立的。由于这是一个较强的假设，“朴素”因此得名，但是朴素贝叶斯依然有出色的性能。由条件独立性假设可以得到</p>
<p>$$<br>\begin {aligned}<br>P(X&#x3D;x|Y&#x3D;c_k)&amp;&#x3D;P(X^{(1)}&#x3D;x^{(1)}, .. , X^{(n)}&#x3D;x^{(n)}|Y&#x3D;c_k) \<br>&amp;&#x3D;\prod_{j&#x3D;1}^n{P(X^{(j)}&#x3D;x^{(j)}|Y&#x3D;c_k)}<br>\end {aligned}  \tag{2.3}<br>$$</p>
<p>朴素贝叶斯实际上学习到了生成数据的机制，所以属于生成模型。</p>
<p>朴素贝叶斯分类时，对给定的输入x，通过后验概率分布$P(Y&#x3D;c_k|X&#x3D;x)$，将后验概率最大的类作为x的类输出。后验概率的计算根据<strong>贝叶斯定理</strong>进行：</p>
<p>$$<br>P(Y&#x3D;c_k|X&#x3D;x)&#x3D;\frac{P(X&#x3D;x|Y&#x3D;c_k)P(Y&#x3D;c_k)}{\sum_{i}^K{P(X&#x3D;x|Y&#x3D;c_i)P(Y&#x3D;c_i)}}  \tag{2.4}<br>$$</p>
<p>将$(2.3)$代入$(2.4)$有</p>
<p>$$<br>P(Y&#x3D;c_k|X&#x3D;x)&#x3D; \frac{P(Y&#x3D;c_k) \prod_{j&#x3D;1}^n P(X^{(j)}&#x3D;x^{(j)}|Y&#x3D;c_k)} { \sum_{i}^K{P(Y&#x3D;c_i) \prod_{j&#x3D;1}^n{P(X^{(j)}&#x3D;x^{(j)}|Y&#x3D;c_i)}}} ,, k&#x3D;1,2,..,K \tag{2.5}<br>$$</p>
<p>这就是朴素贝叶斯分类的基本公式。于是，朴素贝叶斯分类器可表示为</p>
<p>$$<br>y&#x3D;f(x)&#x3D;\mathop{\arg\max}\limits_{c_k}\frac{P(Y&#x3D;c_k)\prod_{j&#x3D;1}^n{P(X^{(j)}&#x3D;x^{(j)}|Y&#x3D;c_k)}}{\sum_{i}^K{P(Y&#x3D;c_i)\prod_{j&#x3D;1}^n{P(X^{(j)}&#x3D;x^{(j)}|Y&#x3D;c_i)}}}  \tag{2.6}<br>$$</p>
<p>在$(2.6)$中，分母对所有$C_k$都是相同的，所以可以进一步简化为</p>
<p>$$y&#x3D;\mathop{\arg\max}<em>{c_k} P(Y&#x3D;c_k) \prod</em>{j&#x3D;1}^n{P(X^{(j)}&#x3D;x^{(j)}|Y&#x3D;c_k)} \tag{2.7}$$</p>
<h3 id="2-3-朴素贝叶斯算法的参数估计"><a href="#2-3-朴素贝叶斯算法的参数估计" class="headerlink" title="2.3 朴素贝叶斯算法的参数估计"></a>2.3 朴素贝叶斯算法的参数估计</h3><p>在朴素贝叶斯中，学习意味着估计$P(Y&#x3D;c_k)$和$P(X^{(j)}&#x3D;x^{(j)}|Y&#x3D;c_k)$，可以使用极大似然法估计相应的概率(思想即伯努利试验的极大似然估计的泛化，详见第一部分)，先验概率$P(y&#x3D;c_k)$ 的极大似然估计是</p>
<p>$$P(Y&#x3D;c_k)&#x3D;\frac{\sum_{i&#x3D;1}^N{I(y_i&#x3D;c_k)}} {N}, k&#x3D;1,2,…,K \tag{2.8}$$</p>
<p>对于条件概率，设第j个特征$x^{(j)}$可能取值的集合为${a_{j1}, a_{j2},.., a_{jS_j}}$，则条件概率 $P(X^{(j)}&#x3D;a_{(jl)}|Y&#x3D;c_k)$ 的极大似然估计是</p>
<p>$$P(X^{(j)}&#x3D;a_{jl}|Y&#x3D;c_k)&#x3D;\frac{\sum_{i&#x3D;1}^N{I(x_i^{(j)}&#x3D;a_{jl},y_i&#x3D;c_k)}} {\sum_{i&#x3D;1}^N{I(y_i&#x3D;c_k)}}  \tag{2.9} $$</p>
<p>$$j&#x3D;1,2,…,n; , l&#x3D;1,2,…, S_i; , k&#x3D;1,2,.., K $$</p>
<p>$(2.9)$中，$x_i^{(j)}$是第i个样本的第j个特征，$a_{jl}$是第j个特征可能取的第$l$个值，$I$为指示函数。</p>
<h3 id="2-4-朴素贝叶斯算法的形式化描述"><a href="#2-4-朴素贝叶斯算法的形式化描述" class="headerlink" title="2.4 朴素贝叶斯算法的形式化描述"></a>2.4 朴素贝叶斯算法的形式化描述</h3><p><strong>输入</strong>：训练数据,训练数据$T&#x3D;\{(x_1,y_1),(x_2,y_2),..,(x_N,y_N)\}$，其中$x_i&#x3D;(x_i^{(1)}, x_i^{(2)}, …, x_i^{(n)} ) ^T$，$x_i^{(j)}$是第i个样本的第j个特征，$x_i^{(j)} \in \{ a_{j1}, a_{j2}, … , a_{jSj}\}$, $a_{jl}$是第$j$个特征可能取得第$l$个值，$j&#x3D;1,2,..,n,, l&#x3D;1,2,…,S_j, y_i \in \{c_1,c_2,..,c_K\}$；实例$x$。</p>
<p><strong>输出</strong>： 实例$x$的分类。</p>
<p>(1) 计算先验概率及条件概率</p>
<p>先验概率</p>
<p>$$P(Y&#x3D;c_k)&#x3D;\frac{\sum_{i&#x3D;1}^N{I(y_i&#x3D;c_k)}}{N}, k&#x3D;1,2,…,K \tag{2.10} $$</p>
<p>条件概率</p>
<p>$$P(X^{(j)}&#x3D;a_{jl}|Y&#x3D;c_k)&#x3D;\frac{\sum_{i&#x3D;1}^N{I(x_i^{(j)}&#x3D;a_{jl},y_i&#x3D;c_k)}}{\sum_{i&#x3D;1}^N{I(y_i&#x3D;c_k)}}  \tag{2.11} $$</p>
<p>$$j&#x3D;1,2,…,n; l&#x3D;1,2,..,S; k&#x3D;1,2,…,K$$</p>
<p>(2) 对于给定的实例$x&#x3D;(x^{(1)},x^{(2)},,…,x^{(n)})$，计算后验概率(该步骤通过贝叶斯公式得到)</p>
<p>$$P(Y&#x3D;c_k|X&#x3D;x)&#x3D;P(Y&#x3D;c_k)\prod_{j&#x3D;1}^n{P(X^{(j)}&#x3D;x^{(j)}|Y&#x3D;c_k)}, k&#x3D;1,2,…,K \tag{2.11} $$</p>
<p>(3) 确定实例x的类</p>
<p>$$y&#x3D;\mathop{\arg\max}<em>{c_k} P(Y&#x3D;c_k) \prod</em>{j&#x3D;1}^n{P(X^{(j)}&#x3D;x^{(j)}|Y&#x3D;c_k)} \tag{2.12} $$</p>
<p>用极大似然估计可能会出现所要估计的概率值为0的情况，这会影响到后验概率的计算结果，使分类产生误差。解决这一问题的方法是采用贝叶斯估计。具体地，<strong>条件概率</strong>的贝叶斯估计是</p>
<p>$$P_{\lambda}{(X^{(j)}&#x3D;a_{jl}|Y&#x3D;c_k)}&#x3D;\frac{\sum_{i&#x3D;1}^N{I(X_i^{(j)} &#x3D; a_{jl},y_i&#x3D;c_k)+\lambda}}{\sum_{i&#x3D;1}^N{I(y_i&#x3D;c_k)+S_i \lambda}} \tag{2.13} $$</p>
<p>其中$\lambda\geq 0$。等价于在随机变量各个取值的频数上赋予一个正数$\lambda&gt;0$。当$\lambda&#x3D;0$时就是极大似然估计。常取$\lambda&#x3D;1$，这时就是拉普拉斯平滑。显然，对任何$l&#x3D;1,2,…,S_j,k&#x3D;1,2,…,K$,有</p>
<p>$$P_{\lambda}(X^{(j)}&#x3D;a_{jl}|Y&#x3D;c_k)&gt;0 \tag{2.14} $$</p>
<p>$$\sum_{l&#x3D;1}^{S_j}{P(X^{(j)}&#x3D;a_{jl}|Y&#x3D;c_k)&#x3D;1} \tag{2.15} $$</p>
<p>这说明式$(2.13)$确是一种概率分布。同样，<strong>先验概率</strong>的贝叶斯估计是</p>
<p>$$P_{\lambda}(Y&#x3D;c_k)&#x3D;\frac{\sum_{i&#x3D;1}^N{I(y_i&#x3D;c_k)+\lambda}}{N+k\lambda} \tag{2.16} $$</p>
<h2 id="3-M估计和拉普拉斯平滑"><a href="#3-M估计和拉普拉斯平滑" class="headerlink" title="3 M估计和拉普拉斯平滑"></a>3 M估计和拉普拉斯平滑</h2><p>对于多分类问题，一般可以通过观测数据来估计类别$c_k$出现的概率 ( 极大似然法 )，即$P(Y&#x3D;c_k)&#x3D;\frac{n_c}{n}$。其中，$n_k$为类别$c_k$的样本数量，$n$为总样本数量。当$n_c$很大的时候，$\frac{n_c}{n}$是对类别$c_k$出现的真实概率$P_{real}(Y&#x3D;c_k)$的良好估计。但是当$n_c$比较小的时候，$\frac{n_c}{n}$会产生有偏估计。当$n_c &#x3D; 0$的时候，$\frac{n_c}{n}&#x3D;0$会对$P_{real}(Y&#x3D;c_k)$产生一个有偏的过低概率估计。由贝叶斯公式可得$P(Y&#x3D;c_k|X&#x3D;x)&#x3D;0$，则类别$c_k$永远不会被分类到。</p>
<p>为了避免此问题，m估计出现了:</p>
<p>$$P(Y&#x3D;c_k)&#x3D;\frac{n_c+mp}{n+m} \tag{3.1}$$</p>
<p>其中$n_c$为该类别$c_k$的样本数量，$n$为总样本数量，$p$为$P(Y&#x3D;c_k)$的先验估计，m为等效样本大小的常量。</p>
<h2 id="4-关于CTR中拉普拉斯平滑分母值的设定"><a href="#4-关于CTR中拉普拉斯平滑分母值的设定" class="headerlink" title="4 关于CTR中拉普拉斯平滑分母值的设定"></a>4 关于CTR中拉普拉斯平滑分母值的设定</h2><p>在CTR(点击率)预估中，拉普拉斯平滑是必要的。</p>
<p>$$ctr&#x3D;\frac{click}{expos} \tag{4.1}$$</p>
<p>$click$是点击次数，$expos$是曝光量次数。</p>
<p>加了拉普拉斯平滑之后，</p>
<p>$$ctr&#x3D;\frac{click+\lambda}{expos+k\lambda}, ,, \lambda&#x3D;1 \tag{4.2}$$</p>
<p>$k$为类别个数，在商品推荐中$k$为item的个数。对于商品a，如果没有曝光 ( $expos&#x3D;0$ ) 的话，此时点击 ( $expos$ ) 也为0。这样的话就是$ctr_a&#x3D;\frac{1}{k}$，也就是将点击 item a 的先验概率赋值给$ctr_a$。换句话说，对于总数为k的商品，在没有任何观测数据的情况下，点击其中一个的概率是$p_{prior}&#x3D;\frac{1}{k}$。这和LDA主题模型也有共通之处。</p>
<h2 id="5-参考"><a href="#5-参考" class="headerlink" title="5 参考"></a>5 参考</h2><ol>
<li><a href="https://zh.wikipedia.org/wiki/%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E4%BC%B0%E8%AE%A1" target="_blank" rel="noopener">最大似然估计</a></li>
<li>统计学习方法[李航]</li>
<li><a href="https://zh.wikipedia.org/wiki/%E8%81%94%E5%90%88%E5%88%86%E5%B8%83" target="_blank" rel="noopener">联合分布</a></li>
<li><a href="https://www.zybuluo.com/codeep/note/163962#3%E5%9C%A8%E5%AD%97%E7%AC%A6%E9%97%B4%E5%8A%A0%E5%85%A5%E7%A9%BA%E6%A0%BC" target="_blank" rel="noopener">Cmd Markdown 公式指导手册</a></li>
<li><a href="https://blog.csdn.net/sinat_37789134/article/details/68948546" target="_blank" rel="noopener">https://blog.csdn.net/sinat_37789134/article/details/68948546</a></li>
<li><a href="https://blog.csdn.net/bbbeoy/article/details/71249316" target="_blank" rel="noopener">拉普拉斯平滑处理 Laplace Smoothing</a></li>
<li><a href="https://www.zhihu.com/question/24261751" target="_blank" rel="noopener">先验分布、后验分布、似然估计这几个概念是什么意思，它们之间的关系是什么？</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%AE%9A%E7%90%86" target="_blank" rel="noopener">贝叶斯定理</a></li>
</ol>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>

<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script></div><div class="tags"><a href="/tags/朴素贝叶斯/">朴素贝叶斯</a><a href="/tags/拉普拉斯平滑/">拉普拉斯平滑</a><a href="/tags/M估计/">M估计</a><a href="/tags/极大似然法/">极大似然法</a></div><script type="text/javascript" src="/js/jquery.js?v=2.0.1" async></script><div class="post-donate"><div id="donate_board" class="donate_bar center"><a id="btn_donate" href="javascript:;" title="打赏" class="btn_donate"></a><div class="donate_txt"> &uarr;<br>谢谢~ 您的支持将鼓励我继续创作！<br></div></div><div id="donate_guide" class="donate_bar center hidden pay"><img src="/img/weChatMoney.png" title="微信打赏" alt="微信打赏"><img src="/img/alipayMoney.png" title="支付宝打赏" alt="支付宝打赏"></div><script type="text/javascript">document.getElementById('btn_donate').onclick = function(){
    $('#donate_board').addClass('hidden');
    $('#donate_guide').removeClass('hidden');
}</script></div><div class="post-share"><div class="bdsharebuttonbox"><span style="float:left;line-height: 28px;height: 28px;font-size:16px;font-weight:blod">分享到：</span><a href="#" data-cmd="more" class="bds_more"></a><a href="#" data-cmd="mshare" title="分享到一键分享" class="bds_mshare"></a><a href="#" data-cmd="fbook" title="分享到Facebook" class="bds_fbook"></a><a href="#" data-cmd="twi" title="分享到Twitter" class="bds_twi"></a><a href="#" data-cmd="linkedin" title="分享到linkedin" class="bds_linkedin"></a><a href="#" data-cmd="youdao" title="分享到有道云笔记" class="bds_youdao"></a><a href="#" data-cmd="evernotecn" title="分享到印象笔记" class="bds_evernotecn"></a><a href="#" data-cmd="weixin" title="分享到微信" class="bds_weixin"></a><a href="#" data-cmd="qzone" title="分享到QQ空间" class="bds_qzone"></a><a href="#" data-cmd="tsina" title="分享到新浪微博" class="bds_tsina"></a></div></div><div class="post-nav"><a href="/2018/11/01/spark程序优化/" class="pre">spark程序设计优化</a><a href="/2018/10/30/详解Attenction机制/" class="next">白话Attenction机制</a></div><div id="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC80MTIyOC8xNzc3Ng=="></div></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-极大似然法"><span class="toc-text">1 极大似然法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-朴素贝叶斯"><span class="toc-text">2 朴素贝叶斯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-联合概率分布"><span class="toc-text">2.1 联合概率分布</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-朴素贝叶斯的推导"><span class="toc-text">2.2 朴素贝叶斯的推导</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-朴素贝叶斯算法的参数估计"><span class="toc-text">2.3 朴素贝叶斯算法的参数估计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-朴素贝叶斯算法的形式化描述"><span class="toc-text">2.4 朴素贝叶斯算法的形式化描述</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-M估计和拉普拉斯平滑"><span class="toc-text">3 M估计和拉普拉斯平滑</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-关于CTR中拉普拉斯平滑分母值的设定"><span class="toc-text">4 关于CTR中拉普拉斯平滑分母值的设定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-参考"><span class="toc-text">5 参考</span></a></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2022/09/07/《KDD2018-Perceive-Your-Users-in-Depth-Learning-Universal-User-Representations-from-Multiple-E-commerce-Tasks》阅读笔记/">《KDD2018 Perceive Your Users in Depth Learning Universal User Representations from Multiple E-commerce Tasks》阅读笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/08/10/《Parameter-Efficient-Transfer-from-Sequential-Behaviors-for-User-Modeling-and-Recommendation》论文阅读/">《Parameter-Efficient Transfer from Sequential Behaviors for User Modeling and Recommendation》论文阅读</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/03/《Towards-Universal-Sequence-Representation-Learning-for-Recommender-Systems》论文阅读笔记/">《Towards Universal Sequence Representation Learning for Recommender Systems》论文阅读笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/07/NLP相关资料整理/">NLP相关资料整理</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/hexo博客链接在微信被屏蔽的解决办法/">hexo博客链接在微信被屏蔽的解决办法</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/TensorFlow的自动求导具体是在哪部分代码里实现的？/">TensorFlow的自动求导具体是在哪部分代码里实现的？</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/tf中如何修改tensor的值/">tf中如何修改tensor的值</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/04/解决tf1-15中tf-scatter-update-函数没有定义梯度的问题/">解决tf1.15中tf.scatter_update()函数没有定义梯度的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/31/解决hexo博客代码在IOS下字体过大的问题/">解决hexo博客代码在IOS下字体过大的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/30/记一次悲催的tf报错/">记一次悲催的tf报错</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithm/">Algorithm</a><span class="category-list-count">22</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DMMLAI/">DMMLAI</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo主题/">Hexo主题</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hive/">Hive</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/NLP/">NLP</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/PL/">PL</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Story/">Story</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/hole/">hole</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mac/">mac</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pytorch/">pytorch</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/sklearn/">sklearn</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tensorflow/">tensorflow</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/例行化/">例行化</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/大数据/">大数据</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/开发/">开发</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/开发工具/">开发工具</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/推荐/">推荐</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/摄影/">摄影</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据获取/">数据获取</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/机器学习/">机器学习</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/深度学习/">深度学习</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/游记/">游记</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/爬虫/">爬虫</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/统计学/">统计学</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/计划/">计划</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/计算广告/">计算广告</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/高并发/">高并发</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/FM/" style="font-size: 15px;">FM</a> <a href="/tags/思考/" style="font-size: 15px;">思考</a> <a href="/tags/cold/" style="font-size: 15px;">cold</a> <a href="/tags/gwen/" style="font-size: 15px;">gwen</a> <a href="/tags/C-C/" style="font-size: 15px;">C/C++</a> <a href="/tags/Java编程思想/" style="font-size: 15px;">Java编程思想</a> <a href="/tags/hive/" style="font-size: 15px;">hive</a> <a href="/tags/kmp/" style="font-size: 15px;">kmp</a> <a href="/tags/字符串匹配/" style="font-size: 15px;">字符串匹配</a> <a href="/tags/FTRL/" style="font-size: 15px;">FTRL</a> <a href="/tags/NLP/" style="font-size: 15px;">NLP</a> <a href="/tags/L2范数，范数/" style="font-size: 15px;">L2范数，范数</a> <a href="/tags/sublime/" style="font-size: 15px;">sublime</a> <a href="/tags/linux性能管理/" style="font-size: 15px;">linux性能管理</a> <a href="/tags/指标/" style="font-size: 15px;">指标</a> <a href="/tags/auc/" style="font-size: 15px;">auc</a> <a href="/tags/tensorflow/" style="font-size: 15px;">tensorflow</a> <a href="/tags/自动求导，自动微分/" style="font-size: 15px;">自动求导，自动微分</a> <a href="/tags/zookepper/" style="font-size: 15px;">zookepper</a> <a href="/tags/centos7/" style="font-size: 15px;">centos7</a> <a href="/tags/hexo，微信屏蔽/" style="font-size: 15px;">hexo，微信屏蔽</a> <a href="/tags/TFRecord/" style="font-size: 15px;">TFRecord</a> <a href="/tags/cpm/" style="font-size: 15px;">cpm</a> <a href="/tags/opcm/" style="font-size: 15px;">opcm</a> <a href="/tags/ecpm/" style="font-size: 15px;">ecpm</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/正则表达式/" style="font-size: 15px;">正则表达式</a> <a href="/tags/tf/" style="font-size: 15px;">tf</a> <a href="/tags/leetcode/" style="font-size: 15px;">leetcode</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/重装系统/" style="font-size: 15px;">重装系统</a> <a href="/tags/OJ/" style="font-size: 15px;">OJ</a> <a href="/tags/dfs/" style="font-size: 15px;">dfs</a> <a href="/tags/递归/" style="font-size: 15px;">递归</a> <a href="/tags/poj/" style="font-size: 15px;">poj</a> <a href="/tags/回文字符串/" style="font-size: 15px;">回文字符串</a> <a href="/tags/dp/" style="font-size: 15px;">dp</a> <a href="/tags/maven/" style="font-size: 15px;">maven</a> <a href="/tags/状态压缩/" style="font-size: 15px;">状态压缩</a> <a href="/tags/BFS/" style="font-size: 15px;">BFS</a> <a href="/tags/位运算/" style="font-size: 15px;">位运算</a> <a href="/tags/pytorch/" style="font-size: 15px;">pytorch</a> <a href="/tags/module/" style="font-size: 15px;">module</a> <a href="/tags/爬虫/" style="font-size: 15px;">爬虫</a> <a href="/tags/暴力/" style="font-size: 15px;">暴力</a> <a href="/tags/棋盘规则/" style="font-size: 15px;">棋盘规则</a> <a href="/tags/shell/" style="font-size: 15px;">shell</a> <a href="/tags/质数/" style="font-size: 15px;">质数</a> <a href="/tags/素数/" style="font-size: 15px;">素数</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/sklearn/" style="font-size: 15px;">sklearn</a> <a href="/tags/spark/" style="font-size: 15px;">spark</a> <a href="/tags/打散/" style="font-size: 15px;">打散</a> <a href="/tags/hole/" style="font-size: 15px;">hole</a> <a href="/tags/roc-auc-score/" style="font-size: 15px;">roc_auc_score</a> <a href="/tags/textFile/" style="font-size: 15px;">textFile</a> <a href="/tags/源码剖析/" style="font-size: 15px;">源码剖析</a> <a href="/tags/rdd计算/" style="font-size: 15px;">rdd计算</a> <a href="/tags/svm多类别分类/" style="font-size: 15px;">svm多类别分类</a> <a href="/tags/网格搜索/" style="font-size: 15px;">网格搜索</a> <a href="/tags/smoothing/" style="font-size: 15px;">smoothing</a> <a href="/tags/tensorboard/" style="font-size: 15px;">tensorboard</a> <a href="/tags/test-in-ubuntu/" style="font-size: 15px;">test in ubuntu</a> <a href="/tags/tf-nn/" style="font-size: 15px;">tf.nn</a> <a href="/tags/tensor/" style="font-size: 15px;">tensor</a> <a href="/tags/cnn/" style="font-size: 15px;">cnn</a> <a href="/tags/gather/" style="font-size: 15px;">gather</a> <a href="/tags/transformer/" style="font-size: 15px;">transformer</a> <a href="/tags/nlp/" style="font-size: 15px;">nlp</a> <a href="/tags/trie/" style="font-size: 15px;">trie</a> <a href="/tags/univesal-embedding/" style="font-size: 15px;">univesal embedding</a> <a href="/tags/word2vec/" style="font-size: 15px;">word2vec</a> <a href="/tags/torch/" style="font-size: 15px;">torch</a> <a href="/tags/torch-geometric/" style="font-size: 15px;">torch-geometric</a> <a href="/tags/多任务学习/" style="font-size: 15px;">多任务学习</a> <a href="/tags/图网络/" style="font-size: 15px;">图网络</a> <a href="/tags/矩阵补全/" style="font-size: 15px;">矩阵补全</a> <a href="/tags/推荐/" style="font-size: 15px;">推荐</a> <a href="/tags/NAS/" style="font-size: 15px;">NAS</a> <a href="/tags/网络修剪/" style="font-size: 15px;">网络修剪</a> <a href="/tags/知识迁移/" style="font-size: 15px;">知识迁移</a> <a href="/tags/神经架构搜索/" style="font-size: 15px;">神经架构搜索</a> <a href="/tags/async/" style="font-size: 15px;">async</a> <a href="/tags/异步/" style="font-size: 15px;">异步</a> <a href="/tags/多进程/" style="font-size: 15px;">多进程</a> <a href="/tags/流数据/" style="font-size: 15px;">流数据</a> <a href="/tags/概念漂移/" style="font-size: 15px;">概念漂移</a> <a href="/tags/二分搜索/" style="font-size: 15px;">二分搜索</a> <a href="/tags/universal-embedding/" style="font-size: 15px;">universal embedding</a> <a href="/tags/迁移学习/" style="font-size: 15px;">迁移学习</a> <a href="/tags/机器学习工具/" style="font-size: 15px;">机器学习工具</a> <a href="/tags/协同过滤/" style="font-size: 15px;">协同过滤</a> <a href="/tags/例行化/" style="font-size: 15px;">例行化</a> <a href="/tags/GCN/" style="font-size: 15px;">GCN</a> <a href="/tags/图卷积/" style="font-size: 15px;">图卷积</a> <a href="/tags/在线学习/" style="font-size: 15px;">在线学习</a> <a href="/tags/逻辑/" style="font-size: 15px;">逻辑</a> <a href="/tags/github-blog/" style="font-size: 15px;">github blog</a> <a href="/tags/评估指标/" style="font-size: 15px;">评估指标</a> <a href="/tags/多标签分类/" style="font-size: 15px;">多标签分类</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">八月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">十二月 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">十一月 2014</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="https://petr-mitrichev.blogspot.com/" title="petr" target="_blank">petr</a><ul></ul><a href="http://blog.pluskid.org/" title="Free Mind" target="_blank">Free Mind</a><ul></ul><a href="http://www.flickering.cn/" title="火光摇曳" target="_blank">火光摇曳</a><ul></ul><a href="https://recsys.acm.org/" title="recsys" target="_blank">recsys</a><ul></ul><a href="https://sites.google.com/site/xreborner/" title="Xreborner" target="_blank">Xreborner</a><ul></ul><a href="http://blog.watashi.ws/" title="watashi" target="_blank">watashi</a><ul></ul><a href="https://toc.csail.mit.edu/user/306" title="WJMZBMR" target="_blank">WJMZBMR</a><ul></ul><a href="http://dongxicheng.org/" title="dongxicheng" target="_blank">dongxicheng</a><ul></ul><a href="https://www.byvoid.com/zht/" title="byvoid" target="_blank">byvoid</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">Baidu Site Haritası</a> |  <a href="/atom.xml">订阅</a> |  <a href="/about/">关于</a></p><p><span> Copyright &copy;<a href="/." rel="nofollow">TiuVe.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script type="text/javascript" src="/js/search.json.js?v=2.0.1"></script><!-- 页面点击小红心，在末尾添加，避免找不到 -->
<script type="text/javascript" src="/js/love.js"></script>
<!-- 背景彩带, true打开，false关闭 --><script type="text/javascript" src="/js/toctotop.js?v=2.0.1" async></script><script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","weixin","tsina","qzone","linkedin","fbook","twi","print","renren","sqq","evernotecn","bdysc","tqq","tqf","bdxc","kaixin001","tieba","douban","bdhome","thx","ibaidu","meilishuo","mogujie","diandian","huaban","duitang","hx","fx","youdao","sdo","qingbiji","people","xinhua","mail","isohu","yaolan","wealink","ty","iguba","h163","copy"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":{},"image":{"viewList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"]}};with(document)0[(getElementsByTagName('head')[0]||head).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script><script>(function(d, s) {
  var j, e = d.getElementsByTagName('body')[0];
  if (typeof LivereTower === 'function') { return; }
  j = d.createElement(s);
  j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
  j.async = true;
  e.appendChild(j);
})(document, 'script');
</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/Epsilon2.1.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>